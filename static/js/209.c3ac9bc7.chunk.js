"use strict";(self.webpackChunkvoice_ai_agent_frontend=self.webpackChunkvoice_ai_agent_frontend||[]).push([[209],{4209:(e,t,s)=>{s.d(t,{worker:()=>p});var o=s(3441),r=s(2073);const n={id:1,username:"testuser",email:"test@example.com",role:"user"},a=[{tool_id:"mcp_system_transfer",name:"System MCP Token Transfer",description:"System default token transfer using MCP.",type:"mcp",provider:"System",server_name:"mcp_server_1",endpoint:{},request_schema:{},response_schema:{},tags:["system","mcp","finance"],created_at:"2024-01-15T10:00:00Z",rating:4.5},{tool_id:"http_system_weather",name:"System HTTP Weather API",description:"System default weather service.",type:"http",provider:"System",endpoint:{url:"https://api.weather.example.com/system",method:"GET",platform_type:"generic_http"},request_schema:{type:"object",properties:{city:{type:"string"}},required:["city"]},response_schema:{},tags:["system","http","weather"],created_at:"2024-02-20T11:00:00Z",rating:4.2},{tool_id:"dev_tool_translator",name:"Advanced Translator (Dev)",description:"Community-provided translation service with more languages.",type:"http",provider:"DeveloperCommunity",isDeveloperTool:!0,endpoint:{url:"https://api.devtranslate.example.com/translate",method:"POST",platform_type:"generic_http"},request_schema:{type:"object",properties:{text:{type:"string"},target_lang:{type:"string"}},required:["text","target_lang"]},response_schema:{},tags:["developer","http","translation","ai"],created_at:"2024-05-01T15:30:00Z",rating:4.8},{tool_id:"dev_tool_imagegen",name:"AI Image Generator (Dev)",description:"Generate images from text prompts, by a third-party dev.",type:"http",provider:"ArtAIProvider",isDeveloperTool:!0,endpoint:{url:"https://api.ai-image.example.com/generate",method:"POST",platform_type:"generic_http"},request_schema:{type:"object",properties:{prompt:{type:"string"}},required:["prompt"]},response_schema:{},tags:["developer","http","image","generation","creative"],created_at:"2024-04-10T09:00:00Z",rating:4.9},{tool_id:"system_music_player",name:"Smart Music Player",description:"Intelligent music streaming service with voice control and personalized recommendations.",type:"http",provider:"System",endpoint:{url:"https://api.music.example.com/player",method:"POST",platform_type:"generic_http"},request_schema:{type:"object",properties:{action:{type:"string"},song:{type:"string"},artist:{type:"string"}},required:["action"]},response_schema:{},tags:["system","http","music","entertainment","voice-control"],created_at:"2024-03-25T14:20:00Z",rating:4.6}];let i=[{tool_id:"dev_owned_dify_app_123",name:"My Custom Dify App (Dev)",description:"A Dify application integrated by the developer.",type:"http",provider:"devuser",isDeveloperTool:!0,status:"enabled",endpoint:{url:"https://dify.example.com/api/dev-app-1/completion-messages",method:"POST",platform_type:"dify",authentication:{type:"bearer",token:"dify-secret-token-dev1"},dify_config:{app_id:"dify-app-id-123",user_query_variable:"query",fixed_inputs:{scene_mode:"chat"}}},documentation:"This is a Dify app for testing. Input: query (string). Output: text response.",request_schema:{},response_schema:{},tags:["developer","http","dify","custom"],created_at:"2024-05-15T10:00:00Z",rating:0},{tool_id:"dev_owned_coze_bot_456",name:"Personal Coze Bot (Dev)",description:"A Coze bot for personal assistance, by the developer.",type:"http",provider:"devuser",isDeveloperTool:!0,status:"disabled",endpoint:{url:"https://coze.example.com/api/v2/chat",method:"POST",platform_type:"coze",authentication:{type:"api_key",key_name:"Authorization",api_key:"Bearer coze-secret-key-dev1"},coze_config:{bot_id:"coze-bot-xyz789",user_query_variable:"query"}},documentation:"This is a Coze bot. Input: query (string). Output: chat message.",request_schema:{},response_schema:{},tags:["developer","http","coze","chatbot"],created_at:"2024-05-16T11:30:00Z",rating:0}];const c=[o.rest.post("/auth/register",(async(e,t,s)=>{const{username:o,email:r,password:n}=await e.json();return o&&r&&n?"existing@example.com"===r?t(s.status(400),s.json({error:{code:"VALIDATION_ERROR",msg:"Email already exists"}})):t(s.status(201),s.json({token:"fake-jwt-register-token-string",user:{id:Math.floor(1e3*Math.random()),username:o,email:r,role:"user"}})):t(s.status(400),s.json({error:{code:"INVALID_PARAM",msg:"Missing fields"}}))})),o.rest.post("/api/v1/auth/token",(async(e,t,s)=>{const o=await e.text(),r=new URLSearchParams(o),n=r.get("username"),a=r.get("password");return console.log("MSW intercepted login request:",{username:n,password:a}),"testuser"===n&&"password"===a?t(s.status(200),s.json({access_token:"abc",user_id:1,role:"user"})):"devuser"===n&&"password"===a?t(s.status(200),s.json({access_token:"abc-dev",user_id:2,role:"developer"})):t(s.status(401),s.json({detail:"Invalid credentials"}))})),o.rest.post("/auth/login",(async(e,t,s)=>{const{username:o,password:r}=await e.json();return"testuser"===o&&"password"===r?t(s.status(200),s.json({token:"abc",user:n})):"devuser"===o&&"password"===r?t(s.status(200),s.json({token:"abc-dev",user:{...n,id:2,username:"devuser",role:"developer"}})):t(s.status(401),s.json({error:{code:"AUTH_FAILED",msg:"Invalid credentials"}}))})),o.rest.get("/api/v1/auth/me",((e,t,s)=>{const o=e.headers.get("Authorization");if(!o||!o.startsWith("Bearer "))return t(s.status(401),s.json({error:{code:"UNAUTHORIZED",msg:"No token provided"}}));const r=o.replace("Bearer ","");return"abc-dev"===r?t(s.status(200),s.json({success:!0,user:{id:2,username:"devuser",email:"dev@example.com",role:"developer"}})):"abc"===r?t(s.status(200),s.json({success:!0,user:{id:1,username:"testuser",email:"test@example.com",role:"user"}})):t(s.status(401),s.json({error:{code:"INVALID_TOKEN",msg:"Invalid token"}}))})),o.rest.get("/api/v1/services",((e,t,s)=>{const o=parseInt(e.url.searchParams.get("page"))||1,r=parseInt(e.url.searchParams.get("page_size"))||10;console.log(`MSW intercepted GET /api/services - \u9875\u7801: ${o}, \u6bcf\u9875\u6570\u91cf: ${r}`);const n=a.length,i=Math.ceil(n/r),c=(o-1)*r,p=c+r,d=a.slice(c,p);return t(s.status(200),s.json({items:d,current_page:o,total_pages:i,total_items:n,page_size:r,has_next:o<i,has_prev:o>1}))})),o.rest.post("/api/v1/interpret",(async(e,t,s)=>{const{sessionId:o,userId:r,query:n}=await e.json();if(!o||void 0===r||!n)return t(s.status(400),s.json({error:{code:"INVALID_PARAM",msg:"Missing fields for interpret"}}));console.log(`MSW intercepted interpret request with query: "${n}"`);const c=n.toLowerCase();if(c.includes("\u4f60\u597d")||c.includes("hello")||c.includes("hi")||n.trim().length<10)return t(s.status(200),s.json({sessionId:o,action:"respond",content:"\u4f60\u597d\uff01\u6211\u662f\u4f60\u7684\u8bed\u97f3\u52a9\u624b\uff0c\u5f88\u9ad8\u5174\u4e3a\u4f60\u670d\u52a1\u3002\u4f60\u53ef\u4ee5\u95ee\u6211\u4efb\u4f55\u95ee\u9898\u6216\u8bf7\u6c42\u5e2e\u52a9\u3002",type:"direct_response"}));let p="unknown_tool",d={},l=`\u6211\u7406\u89e3\u4e86\uff1a"${n}"\u3002\u8fd9\u6837\u5bf9\u5417\uff1f`;if(c.includes("transfer")||c.includes("\u8f6c\u8d26")||c.includes("mcp"))p=a.find((e=>"mcp_system_transfer"===e.tool_id)).tool_id,d={amount:100,currency:"ETH",recipient:"0x123..."},l="\u4f60\u60f3\u8981\u4f7f\u7528MCP\u8f6c\u8d26100 ETH\u52300x123...\u5417\uff1f";else if(c.includes("weather")||c.includes("\u5929\u6c14"))p=a.find((e=>"http_system_weather"===e.tool_id)).tool_id,d={city:"Beijing"},l="\u8981\u67e5\u8be2\u5317\u4eac\u7684\u5929\u6c14\u5417\uff1f";else if(c.includes("translate")||c.includes("\u7ffb\u8bd1")||c.includes("translator"))p=a.find((e=>"dev_tool_translator"===e.tool_id)).tool_id,d={text:"\u4f60\u597d\u4e16\u754c",target_lang:"en"},l='\u8981\u5c06"\u4f60\u597d\u4e16\u754c"\u7ffb\u8bd1\u6210\u82f1\u6587\u5417\uff1f';else if(c.includes("image")||c.includes("\u56fe\u7247")||c.includes("generate picture")||c.includes("\u751f\u6210\u56fe\u7247"))p=a.find((e=>"dev_tool_imagegen"===e.tool_id)).tool_id,d={prompt:"\u4e00\u53ea\u6234\u5e3d\u5b50\u7684\u732b"},l="\u8981\u751f\u6210\u4e00\u5f20\u6234\u5e3d\u5b50\u7684\u732b\u7684\u56fe\u7247\u5417\uff1f";else if(c.includes("music")||c.includes("\u97f3\u4e50")||c.includes("play")||c.includes("\u64ad\u653e")||c.includes("song")||c.includes("\u6b4c\u66f2"))p=a.find((e=>"system_music_player"===e.tool_id)).tool_id,d={action:"play",song:"\u6d41\u884c\u6b4c\u66f2",artist:"\u5404\u79cd\u827a\u672f\u5bb6"},l="\u8981\u4e3a\u4f60\u64ad\u653e\u4e00\u4e9b\u97f3\u4e50\u5417\uff1f";else{const e=i.find((e=>c.includes(e.name.toLowerCase().split(" ")[0])));e&&(p=e.tool_id,d={input:n},l=`\u8981\u4f7f\u7528'${e.name}'\u670d\u52a1\u5904\u7406\u4f60\u7684\u67e5\u8be2\uff1a"${n}"\u5417\uff1f`)}return t(s.status(200),s.json({sessionId:o,tool_calls:[{tool_id:p,parameters:d}],confirm_text:l,type:"tool_call_required"}))})),o.rest.post("/api/v1/execute",(async(e,t,s)=>{const{sessionId:o,userId:r,tool_id:n,params:c}=await e.json();if(!o||!n||!c)return t(s.status(400),s.json({error:{code:"INVALID_PARAM",msg:"Missing fields for execute"}}));const p=[...a,...i].find((e=>e.tool_id===n));if(!p)return t(s.status(404),s.json({error:{code:"TOOL_NOT_FOUND",msg:`Tool ${n} not found`}}));if(p.isDeveloperTool&&"disabled"===p.status)return t(s.status(403),s.json({error:{code:"TOOL_DISABLED",msg:`Tool ${n} is currently disabled by the developer.`}}));let d={};if("mcp"===p.type)d={success:!0,data:{transactionHash:`0x_mcp_tx_${Date.now()}`,message:`MCP call to ${p.name} successful.`}};else if("http"===p.type){var l,u,m;if("dify"===(null===(l=p.endpoint)||void 0===l?void 0:l.platform_type))d={success:!0,data:{answer:`Dify app '${p.name}' processed '${c[(null===(m=p.endpoint.dify_config)||void 0===m?void 0:m.user_query_variable)||"query"]}'. Mocked response.`,conversation_id:`dify_conv_${Date.now()}`}};else if("coze"===(null===(u=p.endpoint)||void 0===u?void 0:u.platform_type)){var _;d={success:!0,data:{answer:`Coze bot '${p.name}' responded to '${c[(null===(_=p.endpoint.coze_config)||void 0===_?void 0:_.user_query_variable)||"query"]}'. This is a mock.`,conversation_id:`coze_conv_${Date.now()}`}}}else if("system_music_player"===p.tool_id){const e=c.action||"play",t=c.song||"Unknown Song",s=c.artist||"Unknown Artist";d={success:!0,data:{message:`\ud83c\udfb5 Music Player: ${"play"===e?"Now playing":e} "${t}" by ${s}`,status:"playing",track:{title:t,artist:s,duration:"3:42"},volume:75}}}else d={success:!0,data:{message:`HTTP call to ${p.name} successful. Input was: ${JSON.stringify(c)}`}}}else d={success:!1,error:{code:"UNKNOWN_TOOL_TYPE",msg:`Tool type ${p.type} not supported for execution.`}};return t(s.status(200),s.json({sessionId:o,...d}))})),o.rest.get("/api/v1/dev/tools",((e,t,s)=>t(s.status(200),s.json({tools:i})))),o.rest.post("/api/v1/dev/tools",(async(e,t,s)=>{const o=await e.json(),n={tool_id:`dev_tool_${(0,r.A)().slice(0,8)}`,provider:"devuser",isDeveloperTool:!0,status:"enabled",created_at:(new Date).toISOString(),rating:0,tags:o.tags||["custom",o.platformType||"http"],name:o.serviceName,description:o.serviceDescription,type:"http",endpoint:{url:o.endpointUrl,method:o.method||"POST",platform_type:o.platformType,authentication:{type:"bearer",token:o.apiKey},..."dify"===o.platformType&&{dify_config:{app_id:o.difyAppId,user_query_variable:o.userInputVar}},..."coze"===o.platformType&&{coze_config:{bot_id:o.cozeBotId,user_query_variable:o.userInputVar}}},documentation:o.documentation};return i.push(n),t(s.status(201),s.json({message:`\u670d\u52a1 "${o.serviceName}" \u5df2\u6210\u529f\u521b\u5efa\uff01`,tool:n}))})),o.rest.put("/api/dev/tools/:toolId",(async(e,t,s)=>{const{toolId:o}=e.params,r=await e.json(),n=i.findIndex((e=>e.tool_id===o));return-1===n?t(s.status(404),s.json({error:"Tool not found"})):(r.status&&(i[n].status=r.status),t(s.status(200),s.json(i[n])))})),o.rest.delete("/api/dev/tools/:toolId",((e,t,s)=>{const{toolId:o}=e.params,r=i.length;return i=i.filter((e=>e.tool_id!==o)),i.length<r?t(s.status(200),s.json({message:"Tool deleted successfully"})):t(s.status(404),s.json({error:"Tool not found for deletion"}))})),o.rest.post("/api/v1/dev/tools/test",(async(e,t,s)=>{const o=await e.json();console.log("Testing tool config:",JSON.stringify(o,null,2));const{tool_config:n,test_input:a}=o,i=a;if(!i||""===i.trim())return t(s.status(400),s.json({success:!1,error:"Test input is required."}));const{platform_type:c,authentication:p,dify_config:d,coze_config:l,endpoint_config:u}=n||{},m=null===p||void 0===p?void 0:p.token,_=null===d||void 0===d?void 0:d.app_id,y=null===l||void 0===l?void 0:l.bot_id,g=null===u||void 0===u?void 0:u.url;let v={success:!1,error:"Unknown platform or configuration error.",raw_response:null};return"dify"===c?m&&_&&g?v={success:!0,message:"Dify API test successful!",raw_response:{dify_answer:`Mock Dify response for '${i}' using app ${_}. This is a simulated test.`,conversation_id:`test_dify_conv_${(0,r.A)()}`}}:v.error="Dify configuration incomplete (API Key, App ID, or URL missing).":"coze"===c?m&&y&&g?v={success:!0,message:"Coze API test successful!",raw_response:{coze_message:`Mock Coze bot ${y} response for '${i}'. Simulation successful.`,messages:[{type:"answer",content:`Mocked Coze: ${i}`}],conversation_id:`test_coze_conv_${(0,r.A)()}`}}:v.error="Coze configuration incomplete (API Key, Bot ID, or URL missing).":"http"===c?m&&g?v={success:!0,message:"Generic HTTP API test successful!",raw_response:{generic_http_data:`Mock generic HTTP response for input '${i}' to URL ${g}. Test OK.`,status_code:200}}:v.error="Generic HTTP configuration incomplete (API Key or URL missing).":v.error=`Platform type '${c}' not supported for testing in mock.`,await new Promise((e=>setTimeout(e,750))),t(s.status(200),s.json(v))})),o.rest.post("/api/v1/dev/upload",((e,t,s)=>t(s.status(200),s.json({message:"File upload acknowledged (mock)"}))))],p=(0,o.setupWorker)(...c)}}]);
//# sourceMappingURL=209.c3ac9bc7.chunk.js.map